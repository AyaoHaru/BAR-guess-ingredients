<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Guess the Drink</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }
    .ingredients {
      margin-bottom: 20px;
    }
    .ingredients div {
      display: inline-block;
      margin: 5px;
      padding: 10px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .game {
      margin-top: 20px;
    }
    .guess-input {
      display: flex;
      margin-bottom: 10px;
    }
    .guess-input input {
      width: 20px;
      margin-right: 5px;
      text-align: center;
    }
    .message {
      margin: 10px 0;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>ä¸‰æ¯å’Œä¸‡äº‹ ä¸€é†‰è§£åƒæ„</h1>
<p style="color: gray; font-size: 14px; margin-top: -10px;">
  è¾“å…¥ 8 ä¸ªä»£è¡¨ææ–™çš„æ•°å­—ï¼ˆ0â€“9ï¼‰ï¼ŒçŒœå‡ºæ­£ç¡®é¡ºåºçš„é¸¡å°¾é…’é…æ–¹ã€‚
  é¡ºåºæ­£ç¡® = ä½ç½®æ­£ç¡®çš„æ•°çš„ä¸ªæ•°ï¼Œææ–™æ­£ç¡®=ææ–™æ­£ç¡®ä½†ä½ç½®ä¸å¯¹çš„ä¸ªæ•°ã€‚
  <br></br>
  æœ‰äº›ææ–™ä¸åƒé¸¡å°¾é…’é‡Œä¼šåŠ çš„ï¼Ÿæˆ‘çŸ¥é“â€¦â€¦æˆ‘çŸ¥é“ã€‚
</p>
<div class="ingredients" id="ingredients-list"></div>

<div class="game">
  <div class="guess-input" id="guess-input"></div>
  <button onclick="submitGuess()">Submit Guess</button>
  <div class="message" id="message"></div>
  <ul id="history"></ul>
</div>

<script>
  const ingredientPool = [
      'æŸ æª¬', 'è–„è·å¶', 'ä¼ç‰¹åŠ ', 'æœ—å§†é…’', 'é¾™èˆŒå…°', 'å¯ä¹',
      'å¥å®æ°´', 'æ©™æ±', 'è¾£æ¤’ç²‰', 'ç›',
      'ç³–æµ†', 'çº¢çŸ³æ¦´ç³–æµ†', 'å†°å—', 'æ¤°å¥¶',
      'æµ“ç¼©å’–å•¡', 'å§œæ±æ±½æ°´', 'è‚‰æ¡‚', 'èœ‚èœœ', 'é’æŸ æ±',
      'æ„Ÿå†’è¯','é…±æ²¹','é†‹','èŠ¥æœ«é…±','è€—æ²¹','ç•ªèŒ„é…±','è¾£æ²¹'
  ];

  const colors = ['red', 'blue', 'green', 'purple', 'orange'];

  const digitToIngredient = {};
  const digitColors = {};
  const usedIngredients = [];

  function getRandomIngredient() {
    let ingredient;
    do {
      ingredient = ingredientPool[Math.floor(Math.random() * ingredientPool.length)];
    } while (usedIngredients.includes(ingredient));
    usedIngredients.push(ingredient);
    return ingredient;
  }

  for (let i = 0; i <= 9; i++) {
    digitToIngredient[i] = getRandomIngredient();
  }

  const colorPairs = {};
  for (let i = 0; i < 10; i += 2) {
    const color = colors[Math.floor(i / 2)];
    digitColors[i] = color;
    digitColors[i + 1] = color;
    colorPairs[color] = [i, i + 1];
  }

  const correctSequence = Array.from({length: 8}, () => Math.floor(Math.random() * 10));
  let attempts = 0;
  const maxAttempts = 12;
  let hintStage = 0;

const colorToChinese = {
  red: 'çº¢ç“¶',
  blue: 'è“ç“¶',
  green: 'ç»¿ç“¶',
  purple: 'ç´«ç“¶',
  orange: 'æ©™ç“¶'
};


  const ingredientList = document.getElementById('ingredients-list');
  for (let i = 0; i <= 9; i++) {
    const div = document.createElement('div');
    div.innerHTML = `<strong>${i}</strong>: ${digitToIngredient[i]} <span style="color:${digitColors[i]}">(${colorToChinese[digitColors[i]]})</span>`;
    ingredientList.appendChild(div);
  }

  const guessInput = document.getElementById('guess-input');
  for (let i = 0; i < 8; i++) {
    const input = document.createElement('input');
    input.maxLength = 1;
    input.type = 'text';
    input.pattern = '[0-9]';
    guessInput.appendChild(input);
  }

  function submitGuess() {
    const inputs = [...guessInput.querySelectorAll('input')];
    const guess = inputs.map(input => parseInt(input.value));
    if (guess.some(isNaN) || guess.length !== 8) {
      document.getElementById('message').textContent = "è¯·è¾“å…¥8ç§è°ƒé…’ææ–™ (0-9)";
      return;
    }

    attempts++;
    let correctPlace = 0;
    let correctNumber = 0;

    const seqCopy = [...correctSequence];
    const guessCopy = [...guess];

    // First pass for correct place
    for (let i = 0; i < 8; i++) {
      if (guess[i] === correctSequence[i]) {
        correctPlace++;
        seqCopy[i] = guessCopy[i] = null;
      }
    }

    // Second pass for correct numbers in wrong place
    for (let i = 0; i < 8; i++) {
      if (guessCopy[i] !== null) {
        const index = seqCopy.indexOf(guessCopy[i]);
        if (index !== -1) {
          correctNumber++;
          seqCopy[index] = null;
        }
      }
    }

    const history = document.getElementById('history');
    const li = document.createElement('li');
    li.textContent = `çŒœæµ‹ ${attempts}: ${guess.join('')} â†’ ${correctPlace} å¤„é¡ºåºæ­£ç¡®, ${correctNumber} ç§ææ–™æ­£ç¡®`;
    history.appendChild(li);

    if (correctPlace === 8) {
      const drinkName = correctSequence.map(num => digitToIngredient[num]).join(' åŠ  ');
      const numberString = correctSequence.join(' ');
      document.getElementById('message').innerHTML = `ğŸ‰ æ­å–œï¼è¿™æ˜¯ä¸€æ¯ç‰¹è°ƒ <strong>${drinkName}</strong>. è¯·äº«ç”¨!<br><em>(å¯¹åº”æ•°å­—: ${numberString})</em>`;
      guessInput.innerHTML = '';
      return;
    }

    if (attempts % 3 === 0 && hintStage < 3) {
      giveHint(hintStage++);
    }

    if (attempts >= maxAttempts) {
      const drinkName = correctSequence.map(num => digitToIngredient[num]).join(' åŠ  ');
      const numberString = correctSequence.join(' ');
      document.getElementById('message').innerHTML = `âŒ çŒœé”™å•¦! è¿™æ˜¯ä¸€æ¯ <strong>${drinkName}</strong>.<br><em>(å¯¹åº”æ•°å­—: ${numberString})</em>`;
      guessInput.innerHTML = '';
    }
  }

  function giveHint(stage) {
    let hint = '';
    if (stage === 0) {
      const color = digitColors[correctSequence[0]];
      hint = `æç¤ºï¼šå¦‚æœè¿™ä¼šç»™ä½ ä¸€äº›çµæ„Ÿâ€”â€”æˆ‘åœ¨å‰3æ­¥åŠ äº†ä¸€ç§ ${colorToChinese[color]} çš„ææ–™ã€‚`;
    } else if (stage === 1) {
      const idx = Math.floor(Math.random() * 8);
      const color = digitColors[correctSequence[idx]];
      hint = `æç¤ºï¼šæ¥ç€ï¼Œæˆ‘åœ¨ç¬¬${idx + 1}æ­¥åŠ äº†ä¸€ç§${colorToChinese[color]}çš„ææ–™!`;
    } else if (stage === 2) {
      const idx = Math.floor(Math.random() * 8);
      const ingredient = digitToIngredient[correctSequence[idx]];
      hint = `æç¤ºï¼šè¿™æ˜¯ç‹¬å®¶ç§˜æ–¹â€”â€”â€”â€”æˆ‘åœ¨ç¬¬${idx + 1}æ­¥åŠ äº†ä¸€äº›${ingredient}â€¦â€¦å¥½å•¦ï¼Œè¿™æ˜¯æœ€åçš„æç¤ºï¼Œå†è¯´ä¸‹å»å°±è¦ç ´åæ¸¸æˆçš„ä¹è¶£äº†ã€‚`;
    }
    const li = document.createElement('li');
    li.textContent = hint;
    li.style.fontStyle = 'italic';
    document.getElementById('history').appendChild(li);
  }
</script>

</body>
</html>

<script src="smart-input.js"></script>

